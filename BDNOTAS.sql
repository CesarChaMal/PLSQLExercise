-- CONNECT SYSTEM
 DROP USER NOTAS CASCADE;
 CREATE USER "NOTAS" IDENTIFIED BY notas
      DEFAULT TABLESPACE "USERS"
      TEMPORARY TABLESPACE "TEMP";

GRANT UNLIMITED TABLESPACE TO "NOTAS";
GRANT CREATE SESSION TO "NOTAS";

 GRANT "CONNECT" TO "NOTAS";
 GRANT "RESOURCE" TO "NOTAS";

 ALTER USER "NOTAS" DEFAULT ROLE ALL;

--------------------------------------------------------
-- Archivo creado  - jueves-mayo-28-2020   
--------------------------------------------------------
--------------------------------------------------------
--  DDL for Table ALUMNO
--------------------------------------------------------

  CREATE TABLE "NOTAS"."ALUMNO" 
   (	"IDALUMNO" CHAR(5 BYTE), 
	"APEALUMNO" VARCHAR2(30 BYTE), 
	"NOMALUMNO" VARCHAR2(30 BYTE), 
	"IDESP" CHAR(3 BYTE), 
	"PROCE" CHAR(1 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Table CURSO
--------------------------------------------------------

  CREATE TABLE "NOTAS"."CURSO" 
   (	"IDCURSO" CHAR(4 BYTE), 
	"NOMCURSO" VARCHAR2(35 BYTE), 
	"CREDITO" NUMBER(*,0)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Table ESPECIALIDAD
--------------------------------------------------------

  CREATE TABLE "NOTAS"."ESPECIALIDAD" 
   (	"IDESP" CHAR(3 BYTE), 
	"NOMESP" VARCHAR2(30 BYTE), 
	"COSTO" NUMBER(8,1)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Table NOTAS
--------------------------------------------------------

  CREATE TABLE "NOTAS"."NOTAS" 
   (	"IDALUMNO" CHAR(5 BYTE), 
	"IDCURSO" CHAR(4 BYTE), 
	"P1" NUMBER(*,0), 
	"P2" NUMBER(*,0)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Table PAGOS
--------------------------------------------------------

  CREATE TABLE "NOTAS"."PAGOS" 
   (	"IDALUMNO" CHAR(5 BYTE), 
	"CICLO" CHAR(6 BYTE), 
	"NCUOTA" NUMBER(*,0), 
	"MONTO" NUMBER(12,2), 
	"FECHA" DATE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
REM INSERTING into NOTAS.ALUMNO
SET DEFINE OFF;
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0001','Valencia salcedo','Christian','E01','N');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0002','Ortiz Rodriguez','Freddy','E01','P');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0003','Silva Mejia','Ruth Ketty','E02','N');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0004','Melendez Noriega','Liliana','E03','P');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0005','Huerta Leon','Silvia','E04','N');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0006','Carranza Fuentes','Maria Elena','E02','P');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0007','Prado Castro','Gabriela','E01','N');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0008','Atuncar Mesias','Juan','E05','P');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0009','Aguilar Zavala','Patricia Elena','E01','P');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0010','Rodruigez Trujillo','Rubén Eduardo','E01','N');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0011','Canales Ruiz','Gino Leonel','E02','P');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0012','Ruiz Quispe','Edgar','E02','N');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0013','PanduroTerrazas','Omar','E03','P');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0014','Zita Padilla','Peter Wilmer','E03','N');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0015','Ternero Ubillús','Luis','E05','P');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0016','Rivera García','Raúl Joel','E04','P');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0017','Pomar García','Ana','E04','P');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0018','Palomares Venegas','Mercedes','E04','N');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0019','Ruiz Venegaz','Luis Alberto','E04','P');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0020','Tejada Bernal','Janet','E04','P');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0021','Sotelo Canales','Juan Carlos','E05','P');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0022','LLosa Montalvan','Karla','E05','P');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0023','Galarza Torres','Hu','E03','P');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0024','Valverde Jaramillo','Saul','E05','N');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0025','Cipriano Avila','Roxana','E04','N');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0026','Rodriguez Quispe','Luis Alberto','E05','P');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0027','Huerta Leon','Marco Antonio','E05','N');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0028','Ortiz Fuentes','Ana María','E04','P');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0029','Rivera Jaramillo','Martha','E05','P');
Insert into NOTAS.ALUMNO (IDALUMNO,APEALUMNO,NOMALUMNO,IDESP,PROCE) values ('A0030','Bustamante Campos','Guino','E05','N');
REM INSERTING into NOTAS.CURSO
SET DEFINE OFF;
Insert into NOTAS.CURSO (IDCURSO,NOMCURSO,CREDITO) values ('C001','Matematica Basica','3');
Insert into NOTAS.CURSO (IDCURSO,NOMCURSO,CREDITO) values ('C002','Filosofia I','6');
Insert into NOTAS.CURSO (IDCURSO,NOMCURSO,CREDITO) values ('C003','Psicologia Industrial','5');
Insert into NOTAS.CURSO (IDCURSO,NOMCURSO,CREDITO) values ('C004','Alritmica','4');
Insert into NOTAS.CURSO (IDCURSO,NOMCURSO,CREDITO) values ('C005','Software de Aplicacion','5');
Insert into NOTAS.CURSO (IDCURSO,NOMCURSO,CREDITO) values ('C006','Lenguaje de Programacion I','5');
Insert into NOTAS.CURSO (IDCURSO,NOMCURSO,CREDITO) values ('C007','Lenguaje Java ','4');
Insert into NOTAS.CURSO (IDCURSO,NOMCURSO,CREDITO) values ('C008','Matematica II','3');
Insert into NOTAS.CURSO (IDCURSO,NOMCURSO,CREDITO) values ('C009','Ingles Tecnico','5');
Insert into NOTAS.CURSO (IDCURSO,NOMCURSO,CREDITO) values ('C010','Lenguaje de Programcion III','3');
Insert into NOTAS.CURSO (IDCURSO,NOMCURSO,CREDITO) values ('C011','Aplicaciones Cliente/Servidor','4');
REM INSERTING into NOTAS.ESPECIALIDAD
SET DEFINE OFF;
Insert into NOTAS.ESPECIALIDAD (IDESP,NOMESP,COSTO) values ('E01','Educacion Informatica','2500');
Insert into NOTAS.ESPECIALIDAD (IDESP,NOMESP,COSTO) values ('E02','Administracion','1800');
Insert into NOTAS.ESPECIALIDAD (IDESP,NOMESP,COSTO) values ('E03','Contabilidad','2000');
Insert into NOTAS.ESPECIALIDAD (IDESP,NOMESP,COSTO) values ('E04','Idiomas','1800');
Insert into NOTAS.ESPECIALIDAD (IDESP,NOMESP,COSTO) values ('E05','Ing. de Sistemas','2800');
REM INSERTING into NOTAS.NOTAS
SET DEFINE OFF;
Insert Into NOTAS.NOTAS Values('A0001','C001',11,17);
Insert Into NOTAS.NOTAS Values('A0001','C003',09,15);
Insert Into NOTAS.NOTAS Values('A0001','C004',18,3);
Insert Into NOTAS.NOTAS Values('A0002','C001',15,9);
Insert Into NOTAS.NOTAS Values('A0002','C002',11,03);
Insert Into NOTAS.NOTAS Values('A0002','C003',14,13);
Insert Into NOTAS.NOTAS Values('A0003','C008',12,13);
Insert Into NOTAS.NOTAS Values('A0003','C005',16,14);
Insert Into NOTAS.NOTAS Values('A0003','C003',8,13);
Insert Into NOTAS.NOTAS Values('A0003','C004',7,14);
Insert Into NOTAS.NOTAS Values('A0004','C006',11,12);
Insert Into NOTAS.NOTAS Values('A0004','C007',9,11);
Insert Into NOTAS.NOTAS Values('A0004','C005',7,12);
Insert Into NOTAS.NOTAS Values('A0005','C004',17,16);
Insert Into NOTAS.NOTAS Values('A0005','C005',12,17);
Insert Into NOTAS.NOTAS Values('A0005','C003',6,13);
Insert Into NOTAS.NOTAS Values('A0006','C004',16,15);
Insert Into NOTAS.NOTAS Values('A0006','C006',5,12);
Insert Into NOTAS.NOTAS Values('A0006','C007',8,13);
Insert Into NOTAS.NOTAS Values('A0007','C002',7,9);
Insert Into NOTAS.NOTAS Values('A0007','C004',12,7);
Insert Into NOTAS.NOTAS Values('A0007','C005',11,6);
Insert Into NOTAS.NOTAS Values('A0008','C008',5,8);
Insert Into NOTAS.NOTAS Values('A0008','C009',7,4);
Insert Into NOTAS.NOTAS Values('A0008','C004',5,13);
Insert Into NOTAS.NOTAS Values('A0009','C005',6,13);
Insert Into NOTAS.NOTAS Values('A0009','C009',18,13);
Insert Into NOTAS.NOTAS Values('A0009','C010',12,15);
Insert Into NOTAS.NOTAS Values('A0010','C010',16,14);
Insert Into NOTAS.NOTAS Values('A0010','C001',5,12);
Insert Into NOTAS.NOTAS Values('A0010','C003',12,11);
Insert Into NOTAS.NOTAS Values('A0011','C001',5,13);
Insert Into NOTAS.NOTAS Values('A0011','C002',11,13);
Insert Into NOTAS.NOTAS Values('A0011','C004',7,03);
Insert Into NOTAS.NOTAS Values('A0012','C004',10,08);
Insert Into NOTAS.NOTAS Values('A0012','C005',7,10);
Insert Into NOTAS.NOTAS Values('A0012','C006',17,10);
Insert Into NOTAS.NOTAS Values('A0013','C001',14,3);
Insert Into NOTAS.NOTAS Values('A0013','C002',7,10);
Insert Into NOTAS.NOTAS Values('A0013','C004',12,13);
Insert Into NOTAS.NOTAS Values('A0013','C003',15,12);
Insert Into NOTAS.NOTAS Values('A0014','C001',11,15);
Insert Into NOTAS.NOTAS Values('A0014','C003',15,13);
Insert Into NOTAS.NOTAS Values('A0014','C004',12,18);
Insert Into NOTAS.NOTAS Values('A0015','C001',5,13);
Insert Into NOTAS.NOTAS Values('A0015','C003',14,13);
Insert Into NOTAS.NOTAS Values('A0015','C004',15,12);
Insert Into NOTAS.NOTAS Values('A0016','C002',6,13);
Insert Into NOTAS.NOTAS Values('A0016','C003',12,11);
Insert Into NOTAS.NOTAS Values('A0016','C006',17,12);
Insert Into NOTAS.NOTAS Values('A0021','C004',8,17);
Insert Into NOTAS.NOTAS Values('A0021','C005',14,3);
Insert Into NOTAS.NOTAS Values('A0021','C006',17,12);
Insert Into NOTAS.NOTAS Values('A0022','C004',17,13);
Insert Into NOTAS.NOTAS Values('A0022','C005',8,13);
Insert Into NOTAS.NOTAS Values('A0022','C003',7,13);
Insert Into NOTAS.NOTAS Values('A0023','C004',10,13);
Insert Into NOTAS.NOTAS Values('A0023','C008',12,13);
Insert Into NOTAS.NOTAS Values('A0023','C009',18,13);
Insert Into NOTAS.NOTAS Values('A0024','C004',10,3);
Insert Into NOTAS.NOTAS Values('A0024','C005',11,9);
Insert Into NOTAS.NOTAS Values('A0024','C003',16,8);
Insert Into NOTAS.NOTAS Values('A0024','C007',16,13);
Insert Into NOTAS.NOTAS Values('A0025','C004',1,13);
Insert Into NOTAS.NOTAS Values('A0025','C005',10,18);
Insert Into NOTAS.NOTAS Values('A0028','C005',16,13);
Insert Into NOTAS.NOTAS Values('A0028','C004',17,7);
Insert Into NOTAS.NOTAS Values('A0029','C004',11,13);
REM INSERTING into NOTAS.PAGOS
SET DEFINE OFF;
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0001','2018-2','1','300',to_date('10-10-2017','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0001','2018-2','2','340',to_date('11-11-2017','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0001','2018-1','3','340',to_date('12-12-2017','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0002','2018-2','1','300',to_date('10-05-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0002','2018-2','2','350',to_date('11-05-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0002','2018-1','1','360',to_date('12-05-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0002','2018-1','2','370',to_date('11-05-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0003','2018-1','1','340',to_date('11-06-2017','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0003','2018-1','2','340',to_date('12-07-2017','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0003','2018-2','1','340',to_date('11-05-2017','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0004','2018-2','1','300',to_date('03-09-2017','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0004','2018-2','2','380',to_date('01-10-2017','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0004','2018-1','1','370',to_date('11-05-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0005','2018-2','1','350',to_date('11-10-2017','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0005','2018-2','2','360',to_date('11-08-2017','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0005','2018-1','1','380',to_date('09-05-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0006','2018-2','3','300',to_date('13-09-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0006','2018-1','1','340',to_date('11-03-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0006','2018-1','2','390',to_date('11-05-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0007','2018-2','1','340',to_date('11-06-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0007','2018-1','1','380',to_date('11-05-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0007','2018-1','2','440',to_date('11-06-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0008','2018-2','1','340',to_date('11-08-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0008','2018-2','2','320',to_date('11-09-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0008','2004-1','1','370',to_date('11-02-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0009','2018-2','1','340',to_date('11-06-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0009','2018-2','2','330',to_date('11-07-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0009','2018-1','1','340',to_date('11-05-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0010','2018-2','1','340',to_date('13-07-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0010','2018-2','2','330',to_date('11-09-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0010','2018-1','1','350',to_date('11-06-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0011','2018-2','1','340',to_date('11-06-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0011','2018-2','2','330',to_date('11-08-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0011','2018-1','2','370',to_date('11-06-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0012','2018-2','1','340',to_date('11-08-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0012','2018-2','2','370',to_date('11-09-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0012','2018-1','1','390',to_date('15-08-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0013','2018-2','1','340',to_date('11-06-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0013','2018-1','1','340',to_date('11-05-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0013','2018-1','2','350',to_date('11-05-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0013','2018-1','3','370',to_date('11-06-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0014','2018-2','1','340',to_date('11-10-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0014','2018-2','2','330',to_date('11-11-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0014','2018-1','1','350',to_date('11-05-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0016','2018-2','1','340',to_date('11-09-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0016','2018-2','2','360',to_date('11-10-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0016','2018-1','1','340',to_date('11-05-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0021','2018-2','1','340',to_date('11-07-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0021','2018-2','2','480',to_date('10-08-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0021','2018-1','1','340',to_date('10-05-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0022','2018-2','1','340',to_date('11-08-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0022','2018-2','2','330',to_date('11-09-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0022','2018-1','1','350',to_date('11-03-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0023','2018-2','1','340',to_date('11-09-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0023','2018-2','2','370',to_date('11-10-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0023','2018-1','1','370',to_date('11-05-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0024','2018-2','1','340',to_date('11-06-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0024','2018-2','2','340',to_date('11-08-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0024','2018-1','1','340',to_date('11-05-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0024','2018-1','2','340',to_date('11-05-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0025','2018-2','1','340',to_date('11-08-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0025','2018-2','2','370',to_date('11-09-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0028','2018-1','1','340',to_date('11-05-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0028','2018-1','2','390',to_date('11-06-2018','DD-MM-YYYY'));
Insert into NOTAS.PAGOS (IDALUMNO,CICLO,NCUOTA,MONTO,FECHA) values ('A0029','2018-1','1','340',to_date('11-06-2018','DD-MM-YYYY'));
--------------------------------------------------------
--  Constraints for Table ESPECIALIDAD
--------------------------------------------------------

  ALTER TABLE "NOTAS"."ESPECIALIDAD" ADD PRIMARY KEY ("IDESP")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "NOTAS"."ESPECIALIDAD" MODIFY ("COSTO" NOT NULL ENABLE);
  ALTER TABLE "NOTAS"."ESPECIALIDAD" MODIFY ("NOMESP" NOT NULL ENABLE);
  ALTER TABLE "NOTAS"."ESPECIALIDAD" MODIFY ("IDESP" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table CURSO
--------------------------------------------------------

  ALTER TABLE "NOTAS"."CURSO" ADD PRIMARY KEY ("IDCURSO")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "NOTAS"."CURSO" MODIFY ("NOMCURSO" NOT NULL ENABLE);
  ALTER TABLE "NOTAS"."CURSO" MODIFY ("IDCURSO" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table NOTAS
--------------------------------------------------------

  ALTER TABLE "NOTAS"."NOTAS" ADD PRIMARY KEY ("IDALUMNO", "IDCURSO")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "NOTAS"."NOTAS" MODIFY ("IDCURSO" NOT NULL ENABLE);
  ALTER TABLE "NOTAS"."NOTAS" MODIFY ("IDALUMNO" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table PAGOS
--------------------------------------------------------

  ALTER TABLE "NOTAS"."PAGOS" ADD PRIMARY KEY ("IDALUMNO", "CICLO", "NCUOTA")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "NOTAS"."PAGOS" MODIFY ("MONTO" NOT NULL ENABLE);
  ALTER TABLE "NOTAS"."PAGOS" MODIFY ("NCUOTA" NOT NULL ENABLE);
  ALTER TABLE "NOTAS"."PAGOS" MODIFY ("CICLO" NOT NULL ENABLE);
  ALTER TABLE "NOTAS"."PAGOS" MODIFY ("IDALUMNO" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table ALUMNO
--------------------------------------------------------

  ALTER TABLE "NOTAS"."ALUMNO" ADD PRIMARY KEY ("IDALUMNO")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "NOTAS"."ALUMNO" MODIFY ("IDESP" NOT NULL ENABLE);
  ALTER TABLE "NOTAS"."ALUMNO" MODIFY ("NOMALUMNO" NOT NULL ENABLE);
  ALTER TABLE "NOTAS"."ALUMNO" MODIFY ("APEALUMNO" NOT NULL ENABLE);
  ALTER TABLE "NOTAS"."ALUMNO" MODIFY ("IDALUMNO" NOT NULL ENABLE);


ALTER SESSION SET current_schema = "NOTAS";

SELECT * FROM ALUMNO;
SELECT * FROM ESPECIALIDAD;
SELECT * FROM NOTAS;
SELECT * FROM CURSO;

SELECT * FROM NOTAS ORDER BY IDCURSO;
SELECT COUNT(*) FROM NOTAS GROUP BY IDCURSO ORDER BY IDCURSO;
SELECT COUNT(*) FROM NOTAS GROUP BY IDCURSO, IDALUMNO ORDER BY IDCURSO;

SELECT 
    A.IDALUMNO,
    MAX(A.APEALUMNO) APEALUMNO,
    MAX(A.NOMALUMNO) NOMALUMNO,
    MAX(N.P1) PARCIAL1,
    MAX(N.P2) PARCIAL2,
    MAX((N.P1 + N.P2)/2) FINAL
FROM 
    NOTAS N, ALUMNO A,CURSO C
WHERE 
    C.IDCURSO='C001' AND N.IDALUMNO=A.IDALUMNO AND C.IDCURSO=N.IDCURSO AND A.IDALUMNO='A0014'
GROUP BY
    A.IDALUMNO;

SELECT 
    A.IDALUMNO,
    MAX(A.APEALUMNO) APEALUMNO,
    MAX(A.NOMALUMNO) NOMALUMNO,
    MAX(N.P1) PARCIAL1,
    MAX(N.P2) PARCIAL2,
    MAX((N.P1 + N.P2)/2) FINAL,
    CASE 
    WHEN MAX((N.P1 + N.P2)/2)>=10 THEN 1
    WHEN MAX((N.P1 + N.P2)/2)<10 THEN 0
    END APROBADO
FROM 
    NOTAS N, ALUMNO A, CURSO C
WHERE 
    C.IDCURSO='C001' AND N.IDALUMNO=A.IDALUMNO AND C.IDCURSO=N.IDCURSO AND A.IDALUMNO='A0014'
GROUP BY
    A.IDALUMNO;

SELECT 
    A.IDALUMNO,
    MAX(A.APEALUMNO) APEALUMNO,
    MAX(A.NOMALUMNO) NOMALUMNO,
    MAX(N.P1) PARCIAL1,
    MAX(N.P2) PARCIAL2,
    MAX((N.P1 + N.P2)/2) FINAL,
    CASE 
    WHEN MAX((N.P1 + N.P2)/2)>=10 THEN 1
    WHEN MAX((N.P1 + N.P2)/2)<10 THEN 0
    END APROBADO
FROM 
    ALUMNO A
INNER JOIN
    NOTAS N
ON     
    N.IDALUMNO=A.IDALUMNO
INNER JOIN
    (SELECT IDCURSO FROM CURSO WHERE IDCURSO='C001') C
ON C.IDCURSO=N.IDCURSO  
WHERE 
     A.IDALUMNO='A0014'
GROUP BY
    A.IDALUMNO;

-- Pasando un codigo de curso en caso que exista muestre los alumnos con su promedio y ademas al final cuantos aprobados y desaprobados hay.
-- Suponiendo que la calificacion aprobatoria es 10

SET SERVEROUTPUT ON;
CREATE OR REPLACE PROCEDURE SP_CURSO(COD IN ALUMNO.IDALUMNO%TYPE)
AS
    NOM VARCHAR2(30);
    ACUM NUMBER(8,1):=0;
    PROMT NUMBER(8,1):=0;
    APROB INT:=0;
    NOAPROB INT:=0;
    CUENTA INT:=0;
BEGIN
    SELECT NOMCURSO INTO NOM FROM CURSO WHERE IDCURSO=COD;
    DBMS_OUTPUT.PUT_LINE('NOMBRE DEL CURSO : ' || NOM);
    
    DECLARE CURSOR TMP IS 
        SELECT 
            A.IDALUMNO,
            MAX(A.APEALUMNO) APEALUMNO,
            MAX(A.NOMALUMNO) NOMALUMNO,
            MAX(N.P1) PARCIAL1,
            MAX(N.P2) PARCIAL2,
            MAX((N.P1 + N.P2)/2) FINAL,
            CASE 
            WHEN MAX((N.P1 + N.P2)/2)>=10 THEN 1
            WHEN MAX((N.P1 + N.P2)/2)<10 THEN 0
            END APROBADO
        FROM 
            ALUMNO A
        INNER JOIN
            NOTAS N
        ON     
            N.IDALUMNO=A.IDALUMNO
        INNER JOIN
            (SELECT IDCURSO FROM CURSO WHERE IDCURSO=COD) C
        ON C.IDCURSO=N.IDCURSO  
        GROUP BY
            A.IDALUMNO;
    BEGIN 
        DBMS_OUTPUT.PUT_LINE(RPAD('CODALUMNO',40) || RPAD('APELLIDO Y NOMBRE',40) || RPAD('PROMEDIO FINAL DEL ALUMNO',40));
    
        FOR RG IN TMP LOOP
            DBMS_OUTPUT.PUT_LINE(RPAD(RG.IDALUMNO, 40) || RPAD(RG.APEALUMNO || ',' || RG.NOMALUMNO, 40) || RPAD(RG.FINAL,40));
            IF RG.APROBADO = 1 THEN
                APROB := APROB + 1;
            ELSE
                NOAPROB := NOAPROB + 1;
            END IF;
            CUENTA:=CUENTA+1;
            ACUM:=ACUM+RG.FINAL;
            PROMT:=ACUM/CUENTA;
        END LOOP;
        DBMS_OUTPUT.PUT_LINE('APROBADOS: ' || APROB);
        DBMS_OUTPUT.PUT_LINE('NO APROBADOS: ' || NOAPROB);
        DBMS_OUTPUT.PUT_LINE('PROMEDIO DEL CURSO: ' || PROMT);
        DBMS_OUTPUT.PUT_LINE('----------------------------');
    END;
    EXCEPTION
        WHEN NO_DATA_FOUND THEN
        DBMS_OUTPUT.PUT_LINE('CODIGO NO EXISTE');
END;
/
EXECUTE SP_CURSO('C001');


SET SERVEROUTPUT ON;
CREATE OR REPLACE PROCEDURE SP_CURSO (COD IN ALUMNO.IDALUMNO%TYPE, TMP OUT SYS_REFCURSOR) 
AS
    NOM VARCHAR2(30);
    ACUM NUMBER(8,1):=0;
    PROMT NUMBER(8,1):=0;
    APROB INT:=0;
    NOAPROB INT:=0;
    CUENTA INT:=0;
    TMP SYS_REFCURSOR;  
BEGIN
    SELECT NOMCURSO INTO NOM FROM CURSO WHERE IDCURSO=COD;
    DBMS_OUTPUT.PUT_LINE('NOMBRE DEL CURSO : ' || NOM);
    
    OPEN TMP FOR
        SELECT 
            A.IDALUMNO,
            MAX(A.APEALUMNO) APEALUMNO,
            MAX(A.NOMALUMNO) NOMALUMNO,
            MAX(N.P1) PARCIAL1,
            MAX(N.P2) PARCIAL2,
            MAX((N.P1 + N.P2)/2) FINAL,
            CASE 
            WHEN MAX((N.P1 + N.P2)/2)>=10 THEN 1
            WHEN MAX((N.P1 + N.P2)/2)<10 THEN 0
            END APROBADO
        FROM 
            ALUMNO A
        INNER JOIN
            NOTAS N
        ON     
            N.IDALUMNO=A.IDALUMNO
        INNER JOIN
            (SELECT IDCURSO FROM CURSO WHERE IDCURSO=COD) C
        ON C.IDCURSO=N.IDCURSO  
        GROUP BY
            A.IDALUMNO;
    BEGIN 
        DBMS_OUTPUT.PUT_LINE(RPAD('CODALUMNO',40) || RPAD('APELLIDO Y NOMBRE',40) || RPAD('PROMEDIO FINAL DEL ALUMNO',40));
            
        FOR RG IN TMP LOOP
            DBMS_OUTPUT.PUT_LINE(RPAD(RG.IDALUMNO, 40) || RPAD(RG.APEALUMNO || ',' || RG.NOMALUMNO, 40) || RPAD(RG.FINAL,40));
            IF RG.APROBADO = 1 THEN
                APROB := APROB + 1;
            ELSE
                NOAPROB := NOAPROB + 1;
            END IF;
            CUENTA:=CUENTA+1;
            ACUM:=ACUM+RG.FINAL;
            PROMT:=ACUM/CUENTA;
        END LOOP;
        DBMS_OUTPUT.PUT_LINE('APROBADOS: ' || APROB);
        DBMS_OUTPUT.PUT_LINE('NO APROBADOS: ' || NOAPROB);
        DBMS_OUTPUT.PUT_LINE('PROMEDIO DEL CURSO: ' || PROMT);
        DBMS_OUTPUT.PUT_LINE('----------------------------');
    END;
    EXCEPTION
        WHEN NO_DATA_FOUND THEN
        DBMS_OUTPUT.PUT_LINE('CODIGO NO EXISTE');
END;
/
variable mycursor refcursor;
-- EXECUTE SP_CURSO('C001');
EXECUTE SP_CURSO('C001', :mycursor);


SET SERVEROUTPUT ON;
CREATE OR REPLACE PROCEDURE calculaCurso (curso IN VARCHAR2, myCursor OUT SYS_REFCURSOR) 
AS
  myCursor SYS_REFCURSOR;  
BEGIN
    DBMS_OUTPUT.PUT_LINE('id del curso ' || curso);
    OPEN myCursor FOR
    SELECT 
        A.IDALUMNO "Codalumno", 
        A.APEALUMNO || ', ' || A.NOMALUMNO "Apellido y nombre",
        (N.P1 + N.P2)/2 Promedio
    FROM ALUMNO A
--    INNER JOIN (SELECT IDALUMNO, IDCURSO, P1, P2 FROM NOTAS WHERE IDCURSO = curso) N
    INNER JOIN (SELECT IDALUMNO, IDCURSO, P1, P2 FROM NOTAS WHERE IDCURSO = 'C001') N
    ON  A.IDALUMNO=N.IDALUMNO;
END;
/
variable mycursor refcursor;
EXEC calculaCurso('C001', :mycursor);
